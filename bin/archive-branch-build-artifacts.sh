#!/bin/bash

set -e
set -u
set -o pipefail

DIR="${BASH_SOURCE%/*}"
if [[ ! -d "$DIR" ]]; then DIR="$PWD"; fi

S3_BUCKET_NAME_ARTIFACTS="$(aws cloudformation list-exports --query 'Exports[?Name==`VueLambdaS3BucketArtifactsName`].Value' --output text)"
S3_BUCKET_NAME_STATIC="$(aws cloudformation list-exports --query 'Exports[?Name==`VueLambdaS3BucketStaticName`].Value' --output text)"
S3_PATH_ARTIFACTS_COMMIT="s3://$S3_BUCKET_NAME_ARTIFACTS/$COMMIT"
S3_PATH_STATIC_BRANCH_SLUG="s3://$S3_BUCKET_NAME_STATIC/$BRANCH_SLUG"

cd "$DIR/../dist/" zip -9qry "dist.zip" "./" && cd -
cd "$DIR/../dist/app" && zip -9qry "lambda.zip" "./" && cd -
cd "$DIR/../dist/viewer-request" && zip -9qry "lambda.zip" "./index.js" && cd -
aws s3 cp "$DIR/../dist/app/lambda.zip" "$S3_PATH_ARTIFACTS_COMMIT/app/lambda.zip"
aws s3 cp "$DIR/../dist/viewer-request/lambda.zip" "$S3_PATH_ARTIFACTS_COMMIT/viewer-request/lambda.zip"

# /*
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.css" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "text/css"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.csv" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "text/csv"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.gif" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "image/gif"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.htm" --include "*.html" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "text/html"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.ico" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.jpg" --include "*.jpeg" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.js" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.json" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "application/json"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.png" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "image/png"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.svg" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.txt" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "text/plain"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.xml" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "application/xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.webmanifest" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-type "application/manifest+json"
# /*.br
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.css.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "text/css"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.csv.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "text/csv"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.gif.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "image/gif"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.htm.br" --include "*.html.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "text/html"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.ico.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.jpg.br" --include "*.jpeg.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.js.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.json.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "application/json"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.png.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "image/png"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.svg.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.txt.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "text/plain"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.xml.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "application/xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.webmanifest.br" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding br --content-type "application/manifest+json"
# /*.gz
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.css.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "text/css"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.csv.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "text/csv"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.gif.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "image/gif"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.htm.gz" --include "*.html.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "text/html"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.ico.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.jpg.gz" --include "*.jpeg.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.js.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.json.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "application/json"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.png.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "image/png"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.svg.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.txt.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "text/plain"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.xml.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "application/xml"
aws s3 sync "$DIR/../dist/static" "$S3_PATH_STATIC_BRANCH_SLUG" --exclude "*" --include "*.webmanifest.gz" --exclude "assets/*" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=43200, public" --content-encoding gzip --content-type "application/manifest+json"
# /assets/*
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.css" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "text/css"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.csv" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "text/csv"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.gif" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "image/gif"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.htm" --include "*.html" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "text/html"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.ico" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.jpg" --include "*.jpeg" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.js" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.json" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "application/json"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.png" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "image/png"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.svg" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.txt" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "text/plain"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.xml" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "application/xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.webmanifest" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-type "application/manifest+json"
# /assets/*.br
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.css.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "text/css"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.csv.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "text/csv"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.gif.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "image/gif"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.htm.br" --include "*.html.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "text/html"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.ico.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.jpg.br" --include "*.jpeg.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.js.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.json.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "application/json"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.png.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "image/png"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.svg.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.txt.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "text/plain"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.xml.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "application/xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.webmanifest.br" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding br --content-type "application/manifest+json"
# /assets/*.gz
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.css.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "text/css"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.csv.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "text/csv"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.gif.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "image/gif"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.htm.gz" --include "*.html.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "text/html"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.ico.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "image/x-icon"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.jpg.gz" --include "*.jpeg.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "image/jpeg"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.js.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "application/javascript"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.json.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "application/json"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.png.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "image/png"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.svg.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "image/svg+xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.txt.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "text/plain"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.xml.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "application/xml"
aws s3 sync "$DIR/../dist/static/assets" "$S3_PATH_STATIC_BRANCH_SLUG/assets" --exclude "*" --include "*.webmanifest.gz" --no-guess-mime-type --metadata-directive REPLACE --cache-control "max-age=31536000, public" --content-encoding gzip --content-type "application/manifest+json"
